<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Estimating cdfs and pdfs, and testing their goodness of fit | Topic 5: Nonparametric statistics</title>
  <meta name="description" content="Estimating cdfs and pdfs, and testing their goodness of fit | Topic 5: Nonparametric statistics" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Estimating cdfs and pdfs, and testing their goodness of fit | Topic 5: Nonparametric statistics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Estimating cdfs and pdfs, and testing their goodness of fit | Topic 5: Nonparametric statistics" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exercises.html"/>
<link rel="next" href="kernel-density-estimation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="" data-path="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html"><i class="fa fa-check"></i>Estimating cdfs and pdfs, and testing their goodness of fit</a>
<ul>
<li class="chapter" data-level="" data-path="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#question-1"><i class="fa fa-check"></i>Question 1</a></li>
<li class="chapter" data-level="" data-path="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#question-2"><i class="fa fa-check"></i>Question 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="kernel-density-estimation.html"><a href="kernel-density-estimation.html"><i class="fa fa-check"></i>Kernel density estimation</a>
<ul>
<li class="chapter" data-level="" data-path="kernel-density-estimation.html"><a href="kernel-density-estimation.html#question-3"><i class="fa fa-check"></i>Question 3</a></li>
<li class="chapter" data-level="" data-path="kernel-density-estimation.html"><a href="kernel-density-estimation.html#question-4"><i class="fa fa-check"></i>Question 4</a></li>
<li class="chapter" data-level="" data-path="kernel-density-estimation.html"><a href="kernel-density-estimation.html#question-5"><i class="fa fa-check"></i>Question 5</a></li>
<li class="chapter" data-level="" data-path="kernel-density-estimation.html"><a href="kernel-density-estimation.html#question-6"><i class="fa fa-check"></i>Question 6</a></li>
<li class="chapter" data-level="" data-path="kernel-density-estimation.html"><a href="kernel-density-estimation.html#question-7"><i class="fa fa-check"></i>Question 7</a></li>
<li class="chapter" data-level="" data-path="kernel-density-estimation.html"><a href="kernel-density-estimation.html#question-8"><i class="fa fa-check"></i>Question 8</a></li>
<li class="chapter" data-level="" data-path="kernel-density-estimation.html"><a href="kernel-density-estimation.html#question-9"><i class="fa fa-check"></i>Question 9</a></li>
<li class="chapter" data-level="" data-path="kernel-density-estimation.html"><a href="kernel-density-estimation.html#question-10"><i class="fa fa-check"></i>Question 10</a></li>
<li class="chapter" data-level="" data-path="kernel-density-estimation.html"><a href="kernel-density-estimation.html#question-11"><i class="fa fa-check"></i>Question 11</a></li>
<li class="chapter" data-level="" data-path="kernel-density-estimation.html"><a href="kernel-density-estimation.html#question-12"><i class="fa fa-check"></i>Question 12</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-independent-samples.html"><a href="nonparametric-tests-for-two-independent-samples.html"><i class="fa fa-check"></i>Nonparametric tests for two independent samples</a>
<ul>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-independent-samples.html"><a href="nonparametric-tests-for-two-independent-samples.html#question-13"><i class="fa fa-check"></i>Question 13</a></li>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-independent-samples.html"><a href="nonparametric-tests-for-two-independent-samples.html#question-14"><i class="fa fa-check"></i>Question 14</a></li>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-independent-samples.html"><a href="nonparametric-tests-for-two-independent-samples.html#question-15"><i class="fa fa-check"></i>Question 15</a></li>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-independent-samples.html"><a href="nonparametric-tests-for-two-independent-samples.html#question-16"><i class="fa fa-check"></i>Question 16</a></li>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-independent-samples.html"><a href="nonparametric-tests-for-two-independent-samples.html#happy"><i class="fa fa-check"></i>Question 17</a></li>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-independent-samples.html"><a href="nonparametric-tests-for-two-independent-samples.html#question-18"><i class="fa fa-check"></i>Question 18</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-dependent-samples.html"><a href="nonparametric-tests-for-two-dependent-samples.html"><i class="fa fa-check"></i>Nonparametric tests for two dependent samples</a>
<ul>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-dependent-samples.html"><a href="nonparametric-tests-for-two-dependent-samples.html#question-19"><i class="fa fa-check"></i>Question 19</a></li>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-dependent-samples.html"><a href="nonparametric-tests-for-two-dependent-samples.html#question-20"><i class="fa fa-check"></i>Question 20</a></li>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-dependent-samples.html"><a href="nonparametric-tests-for-two-dependent-samples.html#question-21"><i class="fa fa-check"></i>Question 21</a></li>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-dependent-samples.html"><a href="nonparametric-tests-for-two-dependent-samples.html#question-22"><i class="fa fa-check"></i>Question 22</a></li>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-dependent-samples.html"><a href="nonparametric-tests-for-two-dependent-samples.html#question-23"><i class="fa fa-check"></i>Question 23</a></li>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-dependent-samples.html"><a href="nonparametric-tests-for-two-dependent-samples.html#question-24"><i class="fa fa-check"></i>Question 24</a></li>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-dependent-samples.html"><a href="nonparametric-tests-for-two-dependent-samples.html#question-25"><i class="fa fa-check"></i>Question 25</a></li>
<li class="chapter" data-level="" data-path="nonparametric-tests-for-two-dependent-samples.html"><a href="nonparametric-tests-for-two-dependent-samples.html#question-26"><i class="fa fa-check"></i>Question 26</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Topic 5: Nonparametric statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit" class="section level1 hasAnchor">
<h1>Estimating cdfs and pdfs, and testing their goodness of fit<a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="question-1" class="section level2 hasAnchor">
<h2>Question 1<a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#question-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let <span class="math inline">\(y_1, \ldots, y_n\)</span> denote the Old Faithful geyser eruption times and assume that these are independent. These are available in as variable <code>eruptions</code> within dataset <code>faithful</code>, which is built in to <code>R</code>.</p>
<ol style="list-style-type: lower-alpha">
<li>(5.2.2) Suppose that the eruption times are normally distributed with unknown mean and unknown variance. Use unbiased method-of-moments estimators to estimate this normal distribution.</li>
</ol>
<hr />
<details>
<summary>
<strong>Solution</strong>
</summary>
<p>We’ll start by checking we have access to the data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(faithful)</span></code></pre></div>
<pre><code>##   eruptions waiting
## 1     3.600      79
## 2     1.800      54
## 3     3.333      74
## 4     2.283      62
## 5     4.533      85
## 6     2.883      55</code></pre>
<p>We’ll use the sample mean as an estimate of <span class="math inline">\(\mu\)</span>, so <span class="math inline">\(\hat \mu =\)</span> 3.4878, and the sample variance as an unbiased estimate of <span class="math inline">\(\sigma^2\)</span>, so <span class="math inline">\(\hat \sigma^2 =\)</span> 1.3027, which we’ll store in <code>R</code> for later use.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb3-1" aria-hidden="true" tabindex="-1"></a>mu_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(faithful<span class="sc">$</span>eruptions)</span>
<span id="cb3-2"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb3-2" aria-hidden="true" tabindex="-1"></a>sigma_hat <span class="ot">&lt;-</span> <span class="fu">sd</span>(faithful<span class="sc">$</span>eruptions)</span></code></pre></div>
<p>Hence our parametric estimate of the distribution of eruption times, assuming times are normally distributed, is <span class="math inline">\(Y \sim N(3.488, 1.141^2)\)</span>, where <span class="math inline">\(Y\)</span> denotes a random eruption time.</p>
</details>
<hr />
<ol start="2" style="list-style-type: lower-alpha">
<li>(5.2.4) Plot the edf of the eruption times alongside your parametric estimate of their normal cdf. Compare the two cdfs.</li>
</ol>
<hr />
<details>
<summary>
<strong>Solution</strong>
</summary>
<p>The following plots the edf and superimposes the <span class="math inline">\(N(3.488, 1.141^2)\)</span> cdf.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(faithful, <span class="fu">aes</span>(<span class="at">x =</span> eruptions)) <span class="sc">+</span> <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">&quot;point&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-2"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> pnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu_hat, <span class="at">sd =</span> sigma_hat))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="exercises_files/figure-html/unnamed-chunk-4-1.png" alt="Fitted normal cdf alongside edf for Old Faithful eruption times." width="384" />
<p class="caption">
Figure 1: Fitted normal cdf alongside edf for Old Faithful eruption times.
</p>
</div>
<p>There is a clear difference between the two cdfs. The edf plateaus around 3 minutes (which is consistent with two modes being visible in the pdf), whereas the parametric normal estimate shows are fairly regularly increasing form (which suggests one mode).</p>
</details>
<hr />
<ol start="3" style="list-style-type: lower-alpha">
<li>(5.2.5) Plot a histogram of the eruption times. Comment on the histogram.</li>
</ol>
<hr />
<details>
<summary>
<strong>Solution</strong>
</summary>
<p>The following plots a histogram and specifies 20 bins.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(faithful, <span class="fu">aes</span>(<span class="at">x =</span> eruptions)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="exercises_files/figure-html/unnamed-chunk-5-1.png" alt="Histogram of Old Faithful eruption times." width="384" />
<p class="caption">
Figure 2: Histogram of Old Faithful eruption times.
</p>
</div>
<p>The histograms shows two bumps, which suggests that distribution of eruption times has two modes (one around 2 minutes and one around 4.5 minutes).</p>
</details>
<hr />
<ol start="4" style="list-style-type: lower-alpha">
<li>(5.3.1) Produce a quantile-quantile plot to compare the eruption times with your parametric normal distribution fit. Comment on how this corresponds to your comments from parts (b) and (c).</li>
</ol>
<hr />
<details>
<summary>
<strong>Solution</strong>
</summary>
<p>There are various ways of producing quantile–quantile plots. I’ve opted for this one.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(faithful, <span class="fu">aes</span>(<span class="at">sample =</span> eruptions)) <span class="sc">+</span> <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb6-2"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">distribution =</span> qnorm, <span class="at">dparams =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu_hat, <span class="at">sd =</span> sigma_hat))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:qq1"></span>
<img src="exercises_files/figure-html/qq1-1.png" alt="Quantile-quantile plot for normal distribution fit to Old Faithful eruption times." width="384" />
<p class="caption">
Figure 3: Quantile-quantile plot for normal distribution fit to Old Faithful eruption times.
</p>
</div>
<p>Were the normal distribution an adequate fit, the points should roughly follow the superimposed line, which has intercept zero and slope 1, but they don’t. Deviating from the line by starting above, going below, going above, and then ending below, is consistent with the assumed distribution (normal) having the wrong number of modes.</p>
<p>Note that we could have produced the quantile-quantile plot slightly more ‘manually’, i.e. by creating the plotting data ourselves. The following does this, but the resulting plot is suppressed because it’s identical to Figure <a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#fig:qq1">3</a>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb7-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(faithful<span class="sc">$</span>eruptions)</span>
<span id="cb7-2"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb7-2" aria-hidden="true" tabindex="-1"></a>qq_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> <span class="fu">sort</span>(faithful<span class="sc">$</span>eruptions))</span>
<span id="cb7-3"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb7-3" aria-hidden="true" tabindex="-1"></a>qq_df<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">qnorm</span>((<span class="dv">1</span><span class="sc">:</span>n)<span class="sc">/</span>(n <span class="sc">+</span> <span class="dv">1</span>), mu_hat, sigma_hat)</span>
<span id="cb7-4"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(qq_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb7-5"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;theoretical&quot;</span>, <span class="at">y =</span> <span class="st">&quot;sample&quot;</span>)</span></code></pre></div>
</details>
<hr />
<ol start="5" style="list-style-type: lower-alpha">
<li>(5.3.2) Use Pearson’s chi-squared test to assess the normal distribution fit to the eruption times using the following bins <span class="math display">\[(-\infty, 2.0), [2.0, 2.5), [2.5, 3.0), [3.0, 3.5), [3.5, 4.0), [4.0, 4.5), [4.5, 5.0), [5.0, \infty)\]</span> and state the hypotheses that you are testing.</li>
</ol>
<hr />
<details>
<summary>
<strong>Solution</strong>
</summary>
<p>Let <span class="math inline">\(Y\)</span> denote a random eruption time. The hypotheses are <span class="math inline">\(H_0: Y\)</span> distributed <span class="math inline">\(N(3.488, 1.141^2)\)</span> versus <span class="math inline">\(H_1: Y\)</span> distributed <span class="math inline">\(N(3.488, 1.141^2)\)</span>.</p>
<p>Let’s start by specifying the bins in , which we’ll do by defining their unique boundaries.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb8-1" aria-hidden="true" tabindex="-1"></a>bins <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="dv">3</span>, <span class="fl">3.5</span>, <span class="dv">4</span>, <span class="fl">4.5</span>, <span class="dv">5</span>, <span class="cn">Inf</span>)</span></code></pre></div>
<p>Next we’ll count how many eruption times fall within each bin. There are various ways of doing this in . Using and then seems one of the tidiest.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb9-1" aria-hidden="true" tabindex="-1"></a>O <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">cut</span>(faithful<span class="sc">$</span>eruptions, bins, <span class="at">right =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<p>Let <span class="math inline">\(\Phi(\,; \mu, \sigma^2)\)</span> denote the <span class="math inline">\(N(\mu, \sigma^2)\)</span> cdf. Under a <span class="math inline">\(N(\mu, \sigma^2)\)</span> model the expected number of eruption times in a bin with boundary <span class="math inline">\((a, b]\)</span> is then <span class="math inline">\(n[\Phi(b; \mu, \sigma^2)\)</span> - <span class="math inline">\(\Phi(a; \mu, \sigma^2)]\)</span>, for sample size <span class="math inline">\(n\)</span>. Hence we need to evaluate <span class="math inline">\(\Phi(-\infty; \mu, \sigma^2), \Phi(2.0; \mu, \sigma^2), \ldots, \Phi(5.0; \mu, \sigma^2), \Phi(\infty; \mu, \sigma^2)\)</span>. The following command does this.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb10-1" aria-hidden="true" tabindex="-1"></a>Phi <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(bins, mu_hat, sigma_hat)</span></code></pre></div>
<p>Then we can calculate the expected number of eruption times per bin with</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb11-1" aria-hidden="true" tabindex="-1"></a>E <span class="ot">&lt;-</span> <span class="fu">length</span>(faithful<span class="sc">$</span>eruptions) <span class="sc">*</span> <span class="fu">diff</span>(Phi)</span></code></pre></div>
<p>and put the observed and expected times into a tidy contingency table.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb12-1" aria-hidden="true" tabindex="-1"></a>contingency <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">Observed =</span> O, <span class="at">Expected =</span> E)</span>
<span id="cb12-2"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(contingency, <span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##          [-Inf,2) [2,2.5) [2.5,3) [3,3.5) [3.5,4) [4,4.5) [4.5,5) [5, Inf)
## Observed    51.00   41.00    5.00    7.00   30.00   73.00   61.00     4.00
## Expected    26.17   26.44   38.39   46.16   45.95   37.87   25.84    25.19</code></pre>
<p>The observed test statistic for Pearson’s chi-squared test is then</p>
<p><span class="math display">\[\begin{align*} x_{obs}^2 = \sum_{j=1}^J \dfrac{(O_j - E_j)^2}{E_j} &amp;= \dfrac{(51 - 26.167)^2}{26.167} + \dfrac{(41 - 26.438)^2}{26.438} + \ldots + \dfrac{(4 - 25.187)^2}{25.187} \\ &amp;= 197.678,\end{align*}\]</span></p>
<p>which we compare against the chi-squared distribution with 5 degrees of freedom. As <span class="math inline">\(\text{Pr}(\chi_{5}^2 &gt; x_{obs}^2) \simeq 0.0000\)</span>, there is incredibly strong evidence to reject <span class="math inline">\(H_0\)</span>, i.e. to reject that eruption times are <span class="math inline">\(N(3.488, 1.141^2)\)</span> distributed.</p>
</details>
<hr />
<ol start="6" style="list-style-type: lower-alpha">
<li>Summarise your findings from parts (a)–(e) above in terms of whether the eruption times are normally distributed.</li>
</ol>
<hr />
<details>
<summary>
<strong>Solution</strong>
</summary>
<p>We fit the ‘best’ normal distribution based on method-of-moments. The edf doesn’t match the parametric cdf estimate, the histogram has two modes, which the normal distribution doesn’t, the quantile-quantile plot points systematically and considerably deviate from the zero intercept unit slope line, and there’s overwhelming evidence to reject that eruption times are <span class="math inline">\(N(3.488, 1.141^2)\)</span> distributed from Pearson’s chi-squared test. All the findings support each other, which is that the <span class="math inline">\(N(3.488, 1.141^2)\)</span> distribution provides a bad representation of eruption times.</p>
<hr />
</div>
<div id="question-2" class="section level2 hasAnchor">
<h2>Question 2<a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#question-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The file <code>exeter2019.csv</code> contains daily mean wind speed measurements in knots recorded at Exeter Airport during 2019. Daily mean wind speeds, given by <code>wind_speed</code>, are measured on given dates, given by <code>date</code>.</p>
<ol style="list-style-type: lower-alpha">
<li>Consider a parametric model for wind speeds that assumes they are normally distributed. Find the normal distribution that fits the wind speeds ‘best’, stating your criteria for best.</li>
</ol>
<hr />
<details>
<summary>
<strong>Solution</strong>
</summary>
<p>We’ll start by loading the data</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb14-1" aria-hidden="true" tabindex="-1"></a>exeter2019 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;exeter2019.csv&quot;</span>)</span></code></pre></div>
<p>We can find the best normal distribution fit either by maximum likelihood or moment-based estimates. Except for scaling by <span class="math inline">\(n\)</span>, where <span class="math inline">\(n\)</span> is the sample size, as opposed to <span class="math inline">\(n - 1\)</span> when calculating the sample variance, both are identical.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb15-1" aria-hidden="true" tabindex="-1"></a>mu_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(exeter2019<span class="sc">$</span>wind_speed)</span>
<span id="cb15-2"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb15-2" aria-hidden="true" tabindex="-1"></a>sigma_hat <span class="ot">&lt;-</span> <span class="fu">sd</span>(exeter2019<span class="sc">$</span>wind_speed)</span></code></pre></div>
<p>and so our sample mean is <span class="math inline">\(\hat \mu = 6.799\)</span> and sample variance is <span class="math inline">\(s^2 = 3.515^2\)</span>, which means that the <span class="math inline">\(N(6.799, 3.515^2)\)</span> is our best normal distribution estimate.</p>
</details>
<hr />
<ol start="2" style="list-style-type: lower-alpha">
<li>Plot the edf of the wind speeds against your parametric distribution estimate and comment on the level of agreement.</li>
</ol>
<hr />
<details>
<summary>
<strong>Solution</strong>
</summary>
<p>The following plots the edf and parametric cdf estimate.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(exeter2019, <span class="fu">aes</span>(<span class="at">x =</span> wind_speed)) <span class="sc">+</span> <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">&quot;point&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-2"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> pnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu_hat, <span class="at">sd =</span> sigma_hat))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-17"></span>
<img src="exercises_files/figure-html/unnamed-chunk-17-1.png" alt="Fitted Normal cdf alongside edf for Exeter wind speeds." width="384" />
<p class="caption">
Figure 4: Fitted Normal cdf alongside edf for Exeter wind speeds.
</p>
</div>
<p>Agreement doesn’t look particularly good, as there’s a systematic difference between the edf and parametric cdf: in comparison to the edf the normal model gives too many low wind speeds (<span class="math inline">\(&lt;\)</span> approx. 9 knots) and too few high wind speeds (<span class="math inline">\(&gt;\)</span> approx. 9 knots).</p>
</details>
<hr />
<ol start="3" style="list-style-type: lower-alpha">
<li>Use a quantile-quantile plot to assess the fit of the distribution.</li>
</ol>
<hr />
<details>
<summary>
<strong>Solution</strong>
</summary>
<p>The following produces a quantile-quantile plot with theoretical plotting positions from the <span class="math inline">\(N(6.799, 3.515^2)\)</span> distribution.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(exeter2019, <span class="fu">aes</span>(<span class="at">sample =</span> wind_speed)) <span class="sc">+</span> <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb17-2"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">distribution =</span> qnorm, <span class="at">dparams =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu_hat, <span class="at">sd =</span> sigma_hat))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-18"></span>
<img src="exercises_files/figure-html/unnamed-chunk-18-1.png" alt="Quantile-quantile plot for normal distribution fit to Exeter wind speeds." width="384" />
<p class="caption">
Figure 5: Quantile-quantile plot for normal distribution fit to Exeter wind speeds.
</p>
</div>
<p>The quantile-quantile plot does not look good: the points systematically and strongly deviate from the line with zero intercept and unit slope. The sample wind speeds start above the line and then drop below and stay below at about 9 knots, which again is consistent with the normal distribution having too little mass below 9 knots and too much above 9 knots. Perhaps most useful for the quantile-quantile plot is that the theoretical wind speeds reach approximately 60 knots, whereas those observed don’t go above 30 knots.</p>
</details>
<hr />
<ol start="4" style="list-style-type: lower-alpha">
<li>Use Pearson’s chi-squared test to formally quantify how unlikely wind speeds are to be normally distributed.</li>
</ol>
<hr />
<details>
<summary>
<strong>Solution</strong>
</summary>
<p>This can either be done with <code>R</code>’s <code>chisq.test()</code> function, or by hand. Here’s the first.</p>
<p>First we need to choose some bins. We’ll use about 15, and let <code>pretty()</code> sort these for us</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb18-1" aria-hidden="true" tabindex="-1"></a>bins <span class="ot">&lt;-</span> <span class="fu">pretty</span>(exeter2019<span class="sc">$</span>wind_speed, <span class="dv">15</span>)</span>
<span id="cb18-2"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb18-2" aria-hidden="true" tabindex="-1"></a>bins[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="cn">Inf</span></span>
<span id="cb18-3"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb18-3" aria-hidden="true" tabindex="-1"></a>bins[<span class="fu">length</span>(bins)] <span class="ot">&lt;-</span> <span class="cn">Inf</span></span></code></pre></div>
<p>and end up with</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb19-1" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="fu">length</span>(bins) <span class="sc">-</span> <span class="dv">1</span></span></code></pre></div>
<p><span class="math inline">\(J = 19\)</span> bins (noting that <code>pretty()</code> doesn’t necessarily use the value that we specify, in order to return some ‘pretty’ values).</p>
<p>Then we need to count how many data points fall in each bin, which we’ll call <code>O</code>, short for ‘observed’.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb20-1" aria-hidden="true" tabindex="-1"></a>O <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">cut</span>(exeter2019<span class="sc">$</span>wind_speed, bins))</span></code></pre></div>
<p>Next we need to find how many points there should be in each bin, if the exponential model is correct, which we’ll call <code>E</code>, short for ‘expected’.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb21-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(exeter2019) <span class="co"># sample size</span></span>
<span id="cb21-2"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb21-2" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(bins, mu_hat, sigma_hat) <span class="co"># prob. less than bin&#39;s right-hand interval</span></span>
<span id="cb21-3"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb21-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">diff</span>(F) <span class="co"># prob. within each bin</span></span>
<span id="cb21-4"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb21-4" aria-hidden="true" tabindex="-1"></a>E <span class="ot">&lt;-</span> n <span class="sc">*</span> p</span></code></pre></div>
<p>This gives the contingency table</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="at">Expected =</span> E, <span class="at">Observed =</span> O)</span></code></pre></div>
<pre><code>##          (-Inf,1]    (1,2]    (2,3]    (3,4]   (4,5]    (5,6]    (6,7]    (7,8]
## Expected 18.06885 13.35612 19.64363 26.65929 33.3858 38.57995 41.13851 40.47832
## Observed  1.00000  8.00000 24.00000 49.00000 56.0000 44.00000 40.00000 37.00000
##             (8,9]   (9,10]  (10,11] (11,12]  (12,13]  (13,14]  (14,15]  (15,16]
## Expected 36.75222 30.79154 23.80487 16.9819 11.17872 6.790202 3.805895 1.968401
## Observed 19.00000 25.00000 15.00000 11.0000 11.00000 9.000000 5.000000 1.000000
##            (16,17]   (17,18] (18, Inf]
## Expected 0.9394026 0.4136852 0.2626857
## Observed 6.0000000 2.0000000 2.0000000</code></pre>
<p>We can calculate our test statistic for Pearson’s chi-squared test with</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb24-1" aria-hidden="true" tabindex="-1"></a>test_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((O <span class="sc">-</span> E)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> E)</span></code></pre></div>
<p>which gives <span class="math inline">\(x_{\text{obs}}^2 = 115.81\)</span>. We have <span class="math inline">\(J = 19\)</span> bins and have estimated two parameters; so we compare against the chi-squared distribution with <span class="math inline">\(\nu = 16\)</span> degrees of freedom. The test’s <span class="math inline">\(p\)</span>-value is Pr<span class="math inline">\((\chi_{16}^2 &gt; x_{\text{obs}})\)</span>, which we can evaluate with</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(test_stat, J <span class="sc">-</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>giving a <span class="math inline">\(p\)</span>-value of Pr<span class="math inline">\((\chi_{16}^2 &gt; x_{\text{obs}}) \simeq 0\)</span>, and so there’s overwhelming evidence against the N<span class="math inline">\((6.799, 3.515^2)\)</span> being a good fit to the wind speeds.</p>
</details>
<hr />
<ol start="5" style="list-style-type: lower-alpha">
<li>Consider the log-Normal distribution as an alternative parametric model for the wind speeds. Note that if <span class="math inline">\(X \sim \text{log-Normal}(\mu, \sigma^2)\)</span> then <span class="math inline">\(\log X \sim N(\mu, \sigma^2)\)</span>. Find the best fitting log-Normal distribution. Then repeat parts (a)–(d). Compare your normal and log-Normal fits.</li>
</ol>
<hr />
<details>
<summary>
<strong>Solution</strong>
</summary>
<p>We’ll start by log-transforming the wind speeds, which we’ll add to the data frame as <code>log_wind_speed</code>,</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb27-1" aria-hidden="true" tabindex="-1"></a>exeter2019<span class="sc">$</span>log_wind_speed <span class="ot">&lt;-</span> <span class="fu">log</span>(exeter2019<span class="sc">$</span>wind_speed)</span></code></pre></div>
<p>and then we’ll compute the moment-based estimates, assuming the log-transformed wind speeds are normally distributed,</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb28-1" aria-hidden="true" tabindex="-1"></a>mu_hat2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(exeter2019<span class="sc">$</span>log_wind_speed)</span>
<span id="cb28-2"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb28-2" aria-hidden="true" tabindex="-1"></a>sigma_hat2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(exeter2019<span class="sc">$</span>log_wind_speed)</span></code></pre></div>
<p>which gives an estimated model of log-N<span class="math inline">\((1.784, 0.527^2)\)</span>. The following then plots the estimated log-Normal cdf against the edf</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(exeter2019, <span class="fu">aes</span>(<span class="at">x =</span> wind_speed)) <span class="sc">+</span> <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">&quot;point&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-2"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">pnorm</span>(<span class="fu">log</span>(x), mu_hat2, sigma_hat2))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-29"></span>
<img src="exercises_files/figure-html/unnamed-chunk-29-1.png" alt="Fitted log-Normal cdf alongside edf for Exeter wind speeds." width="384" />
<p class="caption">
Figure 6: Fitted log-Normal cdf alongside edf for Exeter wind speeds.
</p>
</div>
<p>which looks much better than the normal model. A quantile-quantile plot can be produced with</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb30-1" aria-hidden="true" tabindex="-1"></a>qlognorm <span class="ot">&lt;-</span> <span class="cf">function</span>(p, mu, sigma) <span class="fu">exp</span>(<span class="fu">qnorm</span>(p, mu, sigma))</span>
<span id="cb30-2"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(exeter2019, <span class="fu">aes</span>(<span class="at">sample =</span> wind_speed)) <span class="sc">+</span> <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb30-3"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">distribution =</span> qlognorm, <span class="at">dparams =</span> <span class="fu">list</span>(<span class="at">mu =</span> mu_hat2, <span class="at">sigma =</span> sigma_hat2))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-30"></span>
<img src="exercises_files/figure-html/unnamed-chunk-30-1.png" alt="Quantile-quantile plot for log-Normal fit to Exeter wind speeds." width="384" />
<p class="caption">
Figure 7: Quantile-quantile plot for log-Normal fit to Exeter wind speeds.
</p>
</div>
<p>which looks okay, but we do see some signs of systematic deviation from the zero intercept unit slope line for large wind speeds: theoretical values tending to be larger than those observed suggests the log-Normal model has too much mass in its tail, or we might say that its tail is too heavy. It’s a big improvement over the normal model, though. Finally we’ll test the fit of the log-Normal model with Pearson’s chi-squared test, using similar calculations to the normal model, and re-using objects where possible.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb31-1" aria-hidden="true" tabindex="-1"></a>plognorm <span class="ot">&lt;-</span> <span class="cf">function</span>(x, mu, sigma) <span class="fu">pnorm</span>(<span class="fu">log</span>(x), mu, sigma)</span>
<span id="cb31-2"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb31-2" aria-hidden="true" tabindex="-1"></a>F2 <span class="ot">&lt;-</span> <span class="fu">plognorm</span>(bins, mu_hat2, sigma_hat2)</span></code></pre></div>
<pre><code>## Warning in log(x): NaNs produced</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb33-1" aria-hidden="true" tabindex="-1"></a>F2[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb33-2"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb33-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">diff</span>(F2)</span>
<span id="cb33-3"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb33-3" aria-hidden="true" tabindex="-1"></a>E2 <span class="ot">&lt;-</span> n <span class="sc">*</span> p2</span>
<span id="cb33-4"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb33-4" aria-hidden="true" tabindex="-1"></a>test_stat2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((O <span class="sc">-</span> E2)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> E2)</span>
<span id="cb33-5"><a href="estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(test_stat2, J <span class="sc">-</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.117358</code></pre>
<p>Now we have a much larger <span class="math inline">\(p\)</span>-value and wouldn’t reject the log-Normal<span class="math inline">\((1.784, 0.527^2)\)</span> model at the 10% significance level. We conclude that the log-Normal model is better, but still might try a different distribution with a lighter tail.</p>
</details>
<hr />
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exercises.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="kernel-density-estimation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
