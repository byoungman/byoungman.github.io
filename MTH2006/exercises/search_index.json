[["index.html", "Topic 5: Nonparametric statistics Exercises", " Topic 5: Nonparametric statistics Ben Youngman (b.youngman@exeter.ac.uk, Laver 817) Exercises The following table indicates which questions to attempt before your tutorial in which week. For a few questions, labels, such as (5.2.2), indicate relevant sections of the lecture notes. Week Questions 7 1 - 2 8 3 - 6 9 7 - 12 10 13 - 18 11 19 - 26 "],["estimating-cdfs-and-pdfs-and-testing-their-goodness-of-fit.html", "Estimating cdfs and pdfs, and testing their goodness of fit Question 1 Question 2", " Estimating cdfs and pdfs, and testing their goodness of fit Question 1 Let \\(y_1, \\ldots, y_n\\) denote the Old Faithful geyser eruption times and assume that these are independent. These are available in as variable eruptions within dataset faithful, which is built in to R. (5.2.2) Suppose that the eruption times are normally distributed with unknown mean and unknown variance. Use unbiased method-of-moments estimators to estimate this normal distribution. (5.2.4) Plot the edf of the eruption times alongside your parametric estimate of their normal cdf. Compare the two cdfs. (5.2.5) Plot a histogram of the eruption times. Comment on the histogram. (5.3.1) Produce a quantile-quantile plot to compare the eruption times with your parametric normal distribution fit. Comment on how this corresponds to your comments from parts (b) and (c). (5.3.2) Use Pearson’s chi-squared test to assess the normal distribution fit to the eruption times using the following bins \\[(-\\infty, 2.0), [2.0, 2.5), [2.5, 3.0), [3.0, 3.5), [3.5, 4.0), [4.0, 4.5), [4.5, 5.0), [5.0, \\infty)\\] and state the hypotheses that you are testing. Summarise your findings from parts (a)–(e) above in terms of whether the eruption times are normally distributed. Question 2 The file exeter2019.csv contains daily mean wind speed measurements in knots recorded at Exeter Airport during 2019. Daily mean wind speeds, given by wind_speed, are measured on given dates, given by date. Consider a parametric model for wind speeds that assumes they are normally distributed. Find the normal distribution that fits the wind speeds ‘best’, stating your criteria for best. Plot the edf of the wind speeds against your parametric distribution estimate and comment on the level of agreement. Use a quantile-quantile plot to assess the fit of the distribution. Use Pearson’s chi-squared test to formally quantify how unlikely wind speeds are to be normally distributed. Consider the log-Normal distribution as an alternative parametric model for the wind speeds. Note that if \\(X \\sim \\text{log-Normal}(\\mu, \\sigma^2)\\) then \\(\\log X \\sim N(\\mu, \\sigma^2)\\). Find the best fitting log-Normal distribution. Then repeat parts (b)–(d). Compare your normal and log-Normal fits. "],["kernel-density-estimation.html", "Kernel density estimation Question 3 Question 4 Question 5 Question 6 Question 7 Question 8 Question 9 Question 10 Question 11 Question 12", " Kernel density estimation Question 3 (5.4.1) Consider kernel density estimates for the Old Faithful geyser eruption data using the normal, Epanechnikov, rectangular and triangular kernels. (5.4.5) Plot density estimates for bw = 0.05. Comment on the differences that you observe. [Note that R will rescale bw and so does not directly correspond to \\(h\\) from the lecture notes. You may use either density(...) or ggplot(...) + geom_density(...).] (5.4.4) Use trial and error to find sensible values of bw for the normal and Epanechnikov kernels. Question 4 (5.4.3) If a variable \\(U\\) has pdf \\(f_U(u) = w(u)\\), where \\(w(u)\\) is the triangular kernel function, find \\(\\text{E}(U)\\) and \\(\\text{Var}(U)\\) and hence propose a transformation of the form \\(aU\\) such that the triangular kernel function can be modified to have unit variance. Question 5 Consider a kernel density estimate, \\(\\widehat f_h(y)\\), for the Exeter Airport wind speeds of Question 2. The following function evaluates \\(\\widehat f_h(y)\\), a kernel density estimate for bandwidth at value(s) for kernel function based on sample . kde &lt;- function(y, data, w, h) { d &lt;- outer(y, data, FUN = &quot;-&quot;) rowMeans(w(d / h)) / h } [Note that returns a \\(m \\times n\\) matrix, if supplied an \\(m\\)-vector , i.e. \\((x_1, \\ldots, x_m)&#39;\\), and \\(n\\)-vector , i.e. \\((y_1, \\ldots, y_n)&#39;\\). Specifying stipulates to use the minus function, so that the matrix’s \\((i, j)\\)th element is \\(x_i - y_j\\), for \\(i = 1, \\ldots, m\\) and \\(j = 1, \\ldots, n\\). Also note that there are many other ways of writing a function to evaluate \\(\\widehat f_h(y)\\).] Write a function to evaluate the rectangular kernel function. Use the function kde() to evaluate \\(\\widehat f_h(y)\\) for the wind speeds with \\(y = 1, 1.5, 2, \\ldots, 5, 5.5\\), bandwidth \\(h = 1.5\\) and a rectangular kernel function. Re-evaluate \\(\\widehat f_h(y)\\) for \\(y = 1, 1.5, 2, \\ldots, 5, 5.5\\) for bandwidth \\(h = 1.5\\) using the Epanechnikov kernel function instead. Then plot \\(\\widehat f_h(y)\\) over a sensible range. Question 6 Let \\(\\mathbf{y} = (y_1, \\ldots, y_n)\\) denote the non-zero Teignmouth daily rainfall amounts for 2019 and let \\(\\mathbf{z} = (z_1, \\ldots, z_n)\\), where \\(z_i = \\log(y_i)\\) for \\(i = 1, \\ldots, n\\). Then \\[ \\widehat f_{z, h}(z) = \\dfrac{1}{nh} \\sum_{i = 1}^n w\\left(\\dfrac{z - z_i}{h}\\right) \\] gives a kernel density estimate of the log-transformed non-zero rainfall amounts. We can directly produce an estimate of the pdf of the actual rainfall amounts with \\[ \\widehat f_{y, h}(y) = \\dfrac{\\widehat f_{z, h}(\\log y)}{y}. \\] Use function kde() from Question 5 to estimate and then plot a kernel density estimate for the log-transformed non-zero rainfall amounts using \\(h = 0.6\\) and a normal kernel function. Use your estimate from part (a) to plot the estimated pdf of the actual non-zero rainfall amounts (i.e. on their original scale) based on the kernel density estimate of the log-transformed amounts. Question 7 (5.4.6) Consider an iid random sample \\(Y_1, \\ldots, Y_n\\) with pdf \\(f_Y(y) = \\phi(y)\\), where \\(\\phi()\\) denotes the standard normal distribution. Show that a kernel density estimate, \\(\\widehat f_h(y)\\), with bandwidth \\(h\\) has approximate bias \\[\\dfrac{h^2 \\sigma_w^2 (y^2 - 1)}{2\\sqrt{2 \\pi}} \\text{e}^{-y^2/2}\\] based on a Taylor series expansion and a kernel function \\(w(\\,)\\) with variance \\(\\sigma_w^2\\). Question 8 Consider an iid random sample \\(Y_1, \\ldots, Y_n\\) with pdf \\(f_Y(y)\\). Show that, based on a Taylor expansion, the variance of a kernel density estimate, \\(\\widehat f_h(y)\\), with bandwidth \\(h\\) is approximately \\(\\pi^2 f_Y(y) / (16nh)\\) for the cosine kernel function. Question 9 Consider a kernel density estimate, \\(\\widehat f_h(y)\\), for an iid random sample \\(Y_1, \\ldots, Y_n\\) from the Exp(3) distribution, i.e. with pdf \\[f_Y(y) = \\left\\{\\begin{array}{ll} 3 \\exp(-3 y) &amp; \\text{for}~y &gt; 0, \\\\ 0 &amp; \\text{otherwise}.\\end{array}\\right.\\] Find an approximate expression for the bias of \\(\\widehat f_h(y)\\), based on a Taylor series expansion, if a kernel function \\(w(u)\\) with variance \\(\\sigma_w^2\\) is used with bandwidth \\(h\\). Show that for the rectangular kernel the variance of \\(\\widehat f_h(y)\\) is \\(3\\exp(-3y) / (2nh)\\) for \\(y &gt; 0\\) and zero otherwise. Use your answers to parts (a) and (b) to give the approximate mean integrated squared error (MISE) of \\(\\widehat f_h(y)\\). Use your answers to parts (a)–(c) to give an expression in terms of \\(n\\) for \\(h_{\\text{opt}}\\), the bandwidth that minimises \\(\\text{MISE}[\\widehat f_h]\\). Question 10 Consider a kernel density estimate, \\(\\widehat f_h(y)\\), of an iid Unif\\((a, b)\\) random sample \\(Y_1, \\ldots, Y_n\\) based on a kernel function \\(w(u)\\) and bandwidth \\(h\\). Show that the mean integrated squared error, based on a Taylor series expansion, is approximately \\(\\frac{1}{nh} \\int_{-\\infty}^\\infty w^2(u) \\text{d}u.\\) Question 11 (5.4.7) Consider a kernel density estimate of the Exeter Airport wind speeds based on a normal kernel function. Given that these are a sample of size \\(n = 365\\) with sample variance \\(s^2 = 12.356\\) and sample interquartile range \\(IQR = 4.458\\), find the optimal bandwidths that minimise the mean integrated squared error if the pdf of wind speeds is assumed normal and with Silverman’s rule of thumb. Question 12 For the Old Faithful geyser eruption times use the following R output nrow(faithful) ## [1] 272 sd(faithful$eruptions) ## [1] 1.141371 IQR(faithful$eruptions) ## [1] 2.2915 to confirm the optimal bandwidths \\(h_{\\text{opt}}^N = 0.394\\) and \\(h_{\\text{opt}}^S = 0.335\\) for kernel density estimates based on the normal kernel function. "],["nonparametric-tests-for-two-independent-samples.html", "Nonparametric tests for two independent samples Question 13 Question 14 Question 15 Question 16 Question 17 Question 18", " Nonparametric tests for two independent samples Question 13 (5.5.1) Use Welch’s \\(t\\)-test to assess whether the mean heights of MTH2006 students are different between females and males. Perform the test by hand, and then confirm the result using t.test(). Use a 1% significance level and state any hypotheses that you use. Question 14 (5.5.2) Since 1900 there have been 14 eruptions of the Mauna Loa volcano in Hawaii, US, which occurred in \\[1903,~1907,~1914,~1916,~1919,~1926,~1933,~1935,~1940,~1942,~1949,~1950,~1975,~1984.\\] Use the Kolmogorov-Smirnov test with ks.test() in R to assess at the 1% significance level whether these are uniformly distributed between 1900 and 2020. State the hypotheses that you use. (Recall that punif(x, min = a, max = b) evaluates the Unif\\(([a, b])\\) cdf in R). Question 15 (5.5.3) Consider the Kolmogorov-Smirnov (K-S) test for assessing the null hypothesis that the samples of female and male heights for MTH2006 students are drawn from the same distribution. Plot the edfs of female and male heights (preferably on one plot, for which ggplot(..., aes(x = ..., color = ...) might be useful). Use the edfs to estimate by eye the K-S test statistic, and comment on whether you expect this to support the null hypothesis. Then perform the K-S test in R using ks.test(), stating the hypotheses that you are testing. Question 16 (5.5.4) Load the kickstarter.csv data, which give details on a sample of successful UK Kickstarter campaigns that requested funding under the categories of Film &amp; Video and Music. Amounts pledged for each campaign in USD are stored as usd.pledged. Use the Mann-Whitney \\(U\\) test to assess whether more money tended to be pledged for one type of campaign than the other. State the hypotheses that you are testing. Question 17 The World Happiness Report surveys global happiness. The file happy.csv contains happiness scores from various countries for the years 2016 (score2016) and 2019 (score2019). Use the Mann-Whitney \\(U\\) test to assess whether people were happier in 2019 than in 2016. Question 18 Alongside each track on Spotify is a measure of its ‘energy’, a value between 0 and 1 that captures a song’s speed, loudness, and noisiness, where higher values are more energetic tracks. Let \\(x_1, \\ldots, x_{51}\\) denote the energies of the 51 most popular songs of 2010 and \\(y_1, \\ldots, y_{31}\\) the 31 most popular songs of 2019, where popularity is defined in terms of number of listens. Use the Mann-Whitney \\(U\\) test – and state any hypotheses that you use – to assess whether the most popular songs in 2010 were more energetic than in 2019, given that \\[\\sum_{i=1}^{51} \\sum_{j=1}^{31} I(x_i &gt; y_j) = 1147,~~\\sum_{i=1}^{51} \\sum_{j=1}^{31} I(x_i = y_j) = 0~~~\\text{and}~~~\\sum_{i=1}^{51} \\sum_{j=1}^{31} I(x_i &lt; y_j) = 434.\\] [Note that the raw data used to give the above numbers can be found at .] "],["nonparametric-tests-for-two-dependent-samples.html", "Nonparametric tests for two dependent samples Question 19 Question 20 Question 21 Question 22 Question 23 Question 24 Question 25 Question 26", " Nonparametric tests for two dependent samples Question 19 (5.6.1) A lepidopterist wants to know whether the mean wingspans of female and male gatekeeper butterflies (Pyronia tithonus) differ. They catch 5 females with wingspans of 37, 39, 39, 41 and 43mm and 6 males with wingspans of 42, 42, 44, 46, 47 and 48mm. (All are released unharmed.) Use a permutation test with a 5% significance level to answer the lepidopterist’s question. Question 20 A shoe manufacturer considers two different rubber compositions, A and B, for the soles of children’s shoes. They recruit ten boys, and give each a pair of shoes with one shoe made from composition A and the other shoe made from composition B. Whether the left or right shoe is composition A or B is chosen at random and indicated by ‘L’ or ‘R’, respectively. They record the following amounts of wear for each boy. Boy 1 2 3 4 5 6 7 8 9 10 \\(\\text{Composition A}\\) 13.2 (L) 8.2 (L) 10.9 (R) 14.3 (L) 10.7 (R) 6.6 (L) 9.5 (L) 10.8 (L) 8.8 (R) 13.3 (L) \\(\\text{Composition B}\\) 14.0 (R) 8.8 (R) 11.2 (L) 14.2 (R) 11.8 (L) 6.4 (R) 9.8 (R) 11.3 (R) 9.3 (L) 13.6 (R) \\(\\text{Difference (B - A) }\\) 0.8 0.6 0.3 -0.1 1.1 -0.2 0.3 0.5 0.5 0.3 Composition A is currently being used, but Composition B is cheaper. Use a permutation test based on the difference in mean wear between the compositions to assess whether composition B is less durable than composition A. [Hint: consider finding by inspection the combinations of compositions that give test statistics that are as or more extreme than that of the above data. Calculation in R is much trickier, do doable: if you take this route, modifying expand.grid(c(-1, 1), c(-1, 1)) to have ten c(-1, 1) vectors might help.] Question 21 (5.6.2) The following data are mandible lengths (mm) of ten male and ten female golden jackals (Canis aureus) in the collection at the British Natural History Museum. The two samples are independent. Use a randomisation test at the 5% significance level to assess whether or not there is evidence of a difference in mean mandible length between the females and males in this sample. Question 22 The data Nile, which are built in to R, give annual flows of the river Nile, measured in \\(10^8\\text{m}^3\\), at Aswan, Egypt, for each year from 1871 to 1970. Use a randomisation test to assess whether flows have changed monotonically between 1900 and 1970. State the hypotheses that you are testing. Plot the annual flows between 1900 and 1970, and comment on whether visual inspection supports the results of your hypothesis test. [Note that Nile is a time series object, i.e. of class ts, and you may want to coerce it be of class numeric with as.numeric(). Also note that, to study 1900 to 1970, you will need to somehow remove the first 30 annual flows.] Question 23 (5.6.1, 5.6.2, 5.6.3, 5.7.1) The gapminder.csv data from the Gapminder website give the populations, population, average incomes, income (US dollars), and life expectancies, life, for 184 countries, country. Use a permutation or randomisation test at the 5% significance level to assess whether wealthier people from the 12 most populated countries have longer life expectancies. State your hypotheses and test statistics. Question 24 (5.7.2) An experiment was conducted into whether certain numbers presented in random order were perceived more rapidly in the right (RVF) or left visual fields (LVF) of humans, or whether there was no difference. For each of 12 subjects the mean response times (ms) to digital information in each field was measured. Use the Wilcoxon signed rank test at the 1% significance level to assess whether there is a difference in perception times between the LVF and RVF. Perform the test by hand. Question 25 Recall the happiness data of Question 17. We can consider the scores for 2016 and 2019 as paired scores for each country. For the \\(n = 148\\) countries, let \\(x_i\\) and \\(y_i\\) denote the happiness scores in 2016 and 2019, respectively, for country \\(i\\), \\(i = 1, \\ldots, n\\). Then let \\(r_i\\) denote the rank of \\(|y_i - x_i|\\). Suppose that the differences \\(y_i - x_i\\) are drawn from a symmetric pdf. Given that \\[ \\sum_{i = 1}^n I(x_i &gt; y_i) r_i = 4329.5\\hspace{.8cm}\\text{and}\\hspace{.8cm}\\sum_{i = 1}^n I(y_i &gt; x_i) r_i = 6696.5,\\] use the Wilcoxon signed rank test at the 5% significance level to assess whether happiness scores in 2019 were higher than in 2016. State the hypotheses that you are testing. Question 26 The sleep data, which are built in to R, quantify the extra sleep of ten patients caused by two different soporific drugs, compared to a control setting. In the sleep data, the amount of extra sleep compared to control is identified by extra, patients are identified by variable ID and their drug given by group (which takes value 1 or 2). Consider the Wilcoxon signed rank test for assessing whether sleep amount differs between drug given. State the hypotheses that you are testing, and any assumptions made. You may use wilcox.test() in R or perform calculations by hand (or both!). "]]
