<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.3 Goodness of fit | index.knit</title>
  <meta name="description" content="MTH2006 Topic 5<br />
Nonparametric statistics</div>" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="5.3 Goodness of fit | index.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.3 Goodness of fit | index.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pcdf.html"/>
<link rel="next" href="kde.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="assets/kePrint-0.0.1/kePrint.js"></script>
<link href="assets/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="5" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>5</b> Nonparametric statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="introduction.html"><a href="introduction.html#topic-webpage"><i class="fa fa-check"></i><b>5.1.1</b> Topic webpage</a></li>
<li class="chapter" data-level="5.1.2" data-path="introduction.html"><a href="introduction.html#proposed-learning-schedule"><i class="fa fa-check"></i><b>5.1.2</b> Proposed learning schedule</a></li>
<li class="chapter" data-level="5.1.3" data-path="introduction.html"><a href="introduction.html#office-hour"><i class="fa fa-check"></i><b>5.1.3</b> Office hour</a></li>
<li class="chapter" data-level="5.1.4" data-path="introduction.html"><a href="introduction.html#resources"><i class="fa fa-check"></i><b>5.1.4</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="pcdf.html"><a href="pcdf.html"><i class="fa fa-check"></i><b>5.2</b> Estimating cdfs and pdfs</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="pcdf.html"><a href="pcdf.html#teignmouth-rainfall"><i class="fa fa-check"></i><b>5.2.1</b> Teignmouth rainfall </a></li>
<li class="chapter" data-level="5.2.2" data-path="pcdf.html"><a href="pcdf.html#para"><i class="fa fa-check"></i><b>5.2.2</b> Parametric pdf estimation</a></li>
<li class="chapter" data-level="5.2.3" data-path="pcdf.html"><a href="pcdf.html#ord"><i class="fa fa-check"></i><b>5.2.3</b> Order statistics and ranks</a></li>
<li class="chapter" data-level="5.2.4" data-path="pcdf.html"><a href="pcdf.html#empirical-cdf-estimation"><i class="fa fa-check"></i><b>5.2.4</b> Empirical cdf estimation</a></li>
<li class="chapter" data-level="5.2.5" data-path="pcdf.html"><a href="pcdf.html#hist"><i class="fa fa-check"></i><b>5.2.5</b> Histograms</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="gof.html"><a href="gof.html"><i class="fa fa-check"></i><b>5.3</b> Goodness of fit</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="gof.html"><a href="gof.html#quantilequantile-plots"><i class="fa fa-check"></i><b>5.3.1</b> Quantile–quantile plots</a></li>
<li class="chapter" data-level="5.3.2" data-path="gof.html"><a href="gof.html#pearsons-chi-squared-test"><i class="fa fa-check"></i><b>5.3.2</b> Pearson’s chi-squared test</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="kde.html"><a href="kde.html"><i class="fa fa-check"></i><b>5.4</b> Kernel density estimation</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="kde.html"><a href="kde.html#old-faithful-geyser-eruption-times"><i class="fa fa-check"></i><b>5.4.1</b> Old Faithful geyser eruption times</a></li>
<li class="chapter" data-level="5.4.2" data-path="kde.html"><a href="kde.html#kdedef"><i class="fa fa-check"></i><b>5.4.2</b> Definition</a></li>
<li class="chapter" data-level="5.4.3" data-path="kde.html"><a href="kde.html#kernel-functions"><i class="fa fa-check"></i><b>5.4.3</b> Kernel functions</a></li>
<li class="chapter" data-level="5.4.4" data-path="kde.html"><a href="kde.html#kernel-bandwidth"><i class="fa fa-check"></i><b>5.4.4</b> Kernel bandwidth</a></li>
<li class="chapter" data-level="5.4.5" data-path="kde.html"><a href="kde.html#kernel-density-estimation-in-r"><i class="fa fa-check"></i><b>5.4.5</b> Kernel density estimation in <code>R</code></a></li>
<li class="chapter" data-level="5.4.6" data-path="kde.html"><a href="kde.html#some-properties-of-hatf_hy"><i class="fa fa-check"></i><b>5.4.6</b> Some properties of <span class="math inline">\(\hat{f}_h(y)\)</span></a></li>
<li class="chapter" data-level="5.4.7" data-path="kde.html"><a href="kde.html#nkde"><i class="fa fa-check"></i><b>5.4.7</b> Optimal bandwidths by assuming normal <span class="math inline">\(f_Y(y)\)</span></a></li>
<li class="chapter" data-level="5.4.8" data-path="kde.html"><a href="kde.html#notnkde"><i class="fa fa-check"></i><b>5.4.8</b> Optimal bandwidths for any <span class="math inline">\(f_Y(y)\)</span> by cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="indepsamp.html"><a href="indepsamp.html"><i class="fa fa-check"></i><b>5.5</b> Nonparametric tests for two independent samples</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="indepsamp.html"><a href="indepsamp.html#welchs-t-test"><i class="fa fa-check"></i><b>5.5.1</b> Welch’s <span class="math inline">\(t\)</span>-test</a></li>
<li class="chapter" data-level="5.5.2" data-path="indepsamp.html"><a href="indepsamp.html#kolmogorov-smirnov-test"><i class="fa fa-check"></i><b>5.5.2</b> Kolmogorov-Smirnov test</a></li>
<li class="chapter" data-level="5.5.3" data-path="indepsamp.html"><a href="indepsamp.html#mann-whitney-u-test"><i class="fa fa-check"></i><b>5.5.3</b> Mann-Whitney <span class="math inline">\(U\)</span> test</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="permrand.html"><a href="permrand.html"><i class="fa fa-check"></i><b>5.6</b> Permutation and randomisation tests</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="permrand.html"><a href="permrand.html#permutation"><i class="fa fa-check"></i><b>5.6.1</b> Permutation tests</a></li>
<li class="chapter" data-level="5.6.2" data-path="permrand.html"><a href="permrand.html#randomisation-tests"><i class="fa fa-check"></i><b>5.6.2</b> Randomisation tests</a></li>
<li class="chapter" data-level="5.6.3" data-path="permrand.html"><a href="permrand.html#exspear"><i class="fa fa-check"></i><b>5.6.3</b> Pearson’s correlation coefficient example</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="depsamp.html"><a href="depsamp.html"><i class="fa fa-check"></i><b>5.7</b> Nonparametric measures and tests for two dependent samples</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="depsamp.html"><a href="depsamp.html#spear"><i class="fa fa-check"></i><b>5.7.1</b> Spearman’s rank correlation coefficient</a></li>
<li class="chapter" data-level="5.7.2" data-path="depsamp.html"><a href="depsamp.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>5.7.2</b> Wilcoxon signed rank test</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>5.8</b> Summary</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><div class="line-block">MTH2006 Topic 5<br />
Nonparametric statistics</div></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="gof" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Goodness of fit<a href="gof.html#gof" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Section <a href="pcdf.html#para">5.2.2</a> we fitted exponential and gamma distributions to the Teignmouth rainfall amounts. In this section we consider some nonparametric approaches to assessing whether a distribution is a good fit or not. Note that here nonparametric refers to the assessment methods, and not any probability model used to represent the data.</p>
<div id="quantilequantile-plots" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Quantile–quantile plots<a href="gof.html#quantilequantile-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider a random sample <span class="math inline">\(Y_1, \ldots, Y_n\)</span> from cdf <span class="math inline">\(F_Y(y)\)</span> with corresponding order statistics <span class="math inline">\(Y_{(1)}, \ldots, Y_{(n)}\)</span>. A quantile-quantile (Q-Q) plot is defined by the pairs of points</p>
<p><span class="math display" id="eq:qq">\[\begin{equation}
\mbox{} \hspace{4cm} \left\{F^{-1}_Y\left(\dfrac{i}{n + 1}\right),\, Y_{(i)}\right\} \hspace{2cm} \text{for}~~i = 1, \ldots, n, \tag{5.4}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(F_Y^{-1}(y)\)</span> denotes the inverse cdf. Note that in equation <a href="gof.html#eq:qq">(5.4)</a>, the points <span class="math inline">\(i / (n + 1)\)</span>, for <span class="math inline">\(i = 1, \ldots, n\)</span>, are called <em>plotting positions</em>. <!--, and there's a function `ppoints()` that produces these in `R`, which has been used in Figure \ref{F:qq2}.-->In practice, we’ll have a sample of data data <span class="math inline">\(y_1, \ldots, y_n\)</span> with order statistics <span class="math inline">\(y_{(1)}, \ldots, y_{(n)}\)</span>, and might have a parametric estimate of <span class="math inline">\(F_Y(y; \theta)\)</span>, denoted <span class="math inline">\(F_Y(y; \hat \theta)\)</span>, thus assuming that <span class="math inline">\(F_Y(y)\)</span> depends on some parameter <span class="math inline">\(\theta\)</span>. For the sample we plot <span class="math inline">\(\{F^{-1}_Y(i/(n + 1); \hat \theta), y_{(i)}\}\)</span>.</p>
<p>Let’s consider Q-Q plots for the exponential and gamma fits to the Teignmouth rainfall amounts, which are shown in Figure <a href="gof.html#fig:qq2">5.6</a>, and produced in <code>R</code> with the code below.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="gof.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exponential distribution</span></span>
<span id="cb30-2"><a href="gof.html#cb30-2" aria-hidden="true" tabindex="-1"></a>exp_params <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">rate =</span> theta_hat)</span>
<span id="cb30-3"><a href="gof.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rain, <span class="fu">aes</span>(<span class="at">sample =</span> prcp)) <span class="sc">+</span> </span>
<span id="cb30-4"><a href="gof.html#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">distribution =</span> qexp, <span class="at">dparams =</span> exp_params) <span class="sc">+</span> <span class="fu">geom_abline</span>()</span>
<span id="cb30-5"><a href="gof.html#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma distribution</span></span>
<span id="cb30-6"><a href="gof.html#cb30-6" aria-hidden="true" tabindex="-1"></a>gamma_params <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">shape =</span> gamma_fit<span class="sc">$</span>par[<span class="dv">1</span>], <span class="at">rate =</span> gamma_fit<span class="sc">$</span>par[<span class="dv">2</span>])</span>
<span id="cb30-7"><a href="gof.html#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rain, <span class="fu">aes</span>(<span class="at">sample =</span> prcp)) <span class="sc">+</span> </span>
<span id="cb30-8"><a href="gof.html#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">distribution =</span> qgamma, <span class="at">dparams =</span> gamma_params) <span class="sc">+</span> <span class="fu">geom_abline</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:qq2"></span>
<img src="index_files/figure-html/qq2-1.png" alt="Q-Q plots for exponential (left) and gamma (right) fits to 2019 Teignmouth daily rainfall amounts." width="576" />
<p class="caption">
Figure 5.6: Q-Q plots for exponential (left) and gamma (right) fits to 2019 Teignmouth daily rainfall amounts.
</p>
</div>
<p>On first inspection, we might think from Figure <a href="gof.html#fig:qq2">5.6</a> that either of the exponential and gamma distribution fits are okay. However, if we zoom in to the range <span class="math inline">\([0, 5] \times [0, 5]\)</span>, which is shown in Figure <a href="gof.html#fig:qq3">5.7</a>, then we soon change our mind.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:qq3"></span>
<img src="index_files/figure-html/qq3-1.png" alt="Q-Q plots for exponential (left) and gamma (right) fits to 2019 Teignmouth daily rainfall amounts cropped to [0, 5] x [0, 5]." width="576" />
<p class="caption">
Figure 5.7: Q-Q plots for exponential (left) and gamma (right) fits to 2019 Teignmouth daily rainfall amounts cropped to [0, 5] x [0, 5].
</p>
</div>
<p>From Figure <a href="gof.html#fig:qq3">5.7</a>, the gamma distribution fit still looks okay, but now a systematic discrepancy between the theoretical and sample quantiles for the exponential fit is apparent. Specifically, as the points lie below the zero intercept unit slope line, the theoretical quantiles are larger than the sample quantiles, which corresponds to the fitted exponential distribution having too much mass for small rainfall amounts. The gamma distribution’s added flexibility seems to address this.</p>
<p>If we’re ever unsure of what we should expect a Q-Q plot to look like for a given distribution, we can simply simulate some data from the distribution. Here we’ll simulate six samples the same size as the Teignmouth rainfall sample from the Exp(<span class="math inline">\(\hat \theta\)</span>) distribution, and then produce a Q-Q plot for each simulated sample with a few lines of <code>R</code> code.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="gof.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb31-2"><a href="gof.html#cb31-2" aria-hidden="true" tabindex="-1"></a>  exp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sample =</span> <span class="fu">sort</span>(<span class="fu">rexp</span>(<span class="fu">nrow</span>(rain), <span class="at">rate =</span> theta_hat)))</span>
<span id="cb31-3"><a href="gof.html#cb31-3" aria-hidden="true" tabindex="-1"></a>  exp_df<span class="sc">$</span>theoretical <span class="ot">&lt;-</span> <span class="fu">qexp</span>(<span class="fu">ppoints</span>(<span class="fu">nrow</span>(rain)), <span class="at">rate =</span> theta_hat)</span>
<span id="cb31-4"><a href="gof.html#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(exp_df, <span class="fu">aes</span>(theoretical, sample)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>()</span>
<span id="cb31-5"><a href="gof.html#cb31-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:qq52"></span>
<img src="index_files/figure-html/qq52-1.png" alt="Q-Q plots for six sets of simulated exponential data." width="576" />
<p class="caption">
Figure 5.8: Q-Q plots for six sets of simulated exponential data.
</p>
</div>
<p>We see from Figure <a href="gof.html#fig:qq52">5.8</a> that, even though the simulated samples have come from the distribution against which they are being compared, the points still don’t perfectly follow the line on the Q-Q plot. This is because of <em>sampling variability</em>, which was covered in detail in MTH1004. Therefore, when examining Q-Q plots, we should always expect some deviation from the zero intercept unit slope line. How much deviation is often best estimated through simulation, but we won’t cover that in MTH2006.</p>
</div>
<div id="pearsons-chi-squared-test" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Pearson’s chi-squared test<a href="gof.html#pearsons-chi-squared-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pearson’s chi-squared test, sometimes just called the <em>chi-squared test</em>, is named after Karl Pearson<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>. The chi-squared test can be used to assess whether a distribution is a good fit to a sample of data. It can be motivated by considering the histogram, which counts the <em>observed</em> number of data points in our sample in specified bins. When we estimate a distribution, such as the exponential distribution in Section <a href="pcdf.html#para">5.2.2</a>, we can then obtain the <em>expected</em> number of points within a given bin. The test statistic of the chi-squared test, for a sample with estimated cdf <span class="math inline">\(F_Y(y; \hat \theta)\)</span>, is given by
<span class="math display" id="eq:chisq">\[\begin{equation}
X^2 = \sum_{j=1}^J \dfrac{(O_j - E_j)^2}{E_j}
\tag{5.5}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(O_j = \sum_{i=1}^n I(y_j \in B_j)\)</span> and <span class="math inline">\(E_j = n [F_Y(L + j h; \hat \theta) - F_Y(L + (j - 1) h; \hat \theta)]\)</span> for <span class="math inline">\(j=1, \ldots J\)</span>, with <span class="math inline">\(B_j\)</span>, <span class="math inline">\(L\)</span> and <span class="math inline">\(h\)</span> as defined in Section <a href="pcdf.html#hist">5.2.5</a>.</p>
<p>The statistic <span class="math inline">\(X^2\)</span> has a chi-squared sampling distribution with <span class="math inline">\(J - p - 1\)</span> degrees of freedom, where <span class="math inline">\(p\)</span> is the number of parameters we’ve used estimated to <span class="math inline">\(F_Y(y; \hat \theta)\)</span>, i.e. the number of elements in <span class="math inline">\(\theta\)</span>. If a random variable <span class="math inline">\(W\)</span>, say, has a chi-squared distribution with <span class="math inline">\(\nu\)</span> degrees of freedom, sometimes we’ll just write <span class="math inline">\(W \sim \chi_\nu^2\)</span>. If <span class="math inline">\(W \sim \chi_\nu^2\)</span> then <span class="math inline">\(\text{E}(W) = \nu\)</span> and <span class="math inline">\(\text{Var}(W) = 2\nu\)</span>.</p>
<hr />
<p><strong>Example 1:</strong> Let’s use Pearson’s chi-squared test to assess the fit of the exponential distribution to Teignmouth daily rainfall amounts. We’re testing</p>
<p><span class="math display">\[\begin{align*}
H_0:&amp;~ \text{sample from Exp(}\hat \theta\text{) distribution,}\\
H_1:&amp;~ \text{sample}~not~\text{from Exp(}\hat \theta\text{) distribution.}
\end{align*}\]</span></p>
<p>We’ll start by creating the bins within which we’ll compare observed and expected counts. We’ll let <code>R</code> do this automatically with its <code>pretty()</code> function by specifying that we want roughly 10 bins.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="gof.html#cb32-1" aria-hidden="true" tabindex="-1"></a>(bins <span class="ot">&lt;-</span> <span class="fu">pretty</span>(rain<span class="sc">$</span>prcp, <span class="dv">10</span>))</span></code></pre></div>
<pre><code>##  [1]  0  5 10 15 20 25 30 35 40 45</code></pre>
<p>These bins will cover a finite range. As the exponential distribution’s upper limit is infinite, we’ll modify the right-hand side of the final bin, so that it takes the value <span class="math inline">\(\infty\)</span>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="gof.html#cb34-1" aria-hidden="true" tabindex="-1"></a>bins[<span class="fu">length</span>(bins)] <span class="ot">&lt;-</span> <span class="cn">Inf</span></span></code></pre></div>
<p>Next we’ll find how many observations fall within a given bin. The function can tell us which bin an observation falls in, and then will count the number for each bin.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="gof.html#cb35-1" aria-hidden="true" tabindex="-1"></a>(O <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">cut</span>(rain<span class="sc">$</span>prcp, bins)))</span></code></pre></div>
<pre><code>## 
##    (0,5]   (5,10]  (10,15]  (15,20]  (20,25]  (25,30]  (30,35]  (35,40] 
##      120       42       10        7        4        1        2        0 
## (40,Inf] 
##        1</code></pre>
<p>Then we need to calculate the expected number in each bin. For a sample of size <span class="math inline">\(n\)</span> and bin with interval <span class="math inline">\([a, b]\)</span>, this is given for the Exp(<span class="math inline">\(\theta\)</span>) distribution by <span class="math inline">\(n[F_Y(b; \theta) - F_Y(a; \theta)]\)</span>. Hence we need to evaluate <span class="math inline">\(F_Y(y; \theta)\)</span> for each bin boundary.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="gof.html#cb37-1" aria-hidden="true" tabindex="-1"></a>F_Y <span class="ot">&lt;-</span> <span class="fu">pexp</span>(bins, theta_hat)</span></code></pre></div>
<p>Then we can use the function to calculate <span class="math inline">\(F_Y(b; \theta) - F_Y(a; \theta)\)</span> and then calculate expected numbers per bin.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="gof.html#cb38-1" aria-hidden="true" tabindex="-1"></a>(E <span class="ot">&lt;-</span> <span class="fu">nrow</span>(rain) <span class="sc">*</span> <span class="fu">diff</span>(F_Y))</span></code></pre></div>
<pre><code>## [1] 116.15553814  44.00522242  16.67126364   6.31586471   2.39274886
## [6]   0.90648666   0.34342010   0.13010381   0.07935166</code></pre>
<p>Here we see the observed and expected values per bin.</p>
<p>Noting that we have 9 bins, we can then calculate the chi-squared test statistic, i.e. <span class="math inline">\(\text{x}^2_\text{obs} = \sum_{i = 1}^{9} (O_i - E_i)^2/E_i\)</span>,</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="gof.html#cb40-1" aria-hidden="true" tabindex="-1"></a>(test_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((O <span class="sc">-</span> E)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> E))</span></code></pre></div>
<pre><code>## [1] 22.85414</code></pre>
<p>which has 7 degrees of freedom. The <span class="math inline">\(p\)</span>-value for our test is therefore <span class="math inline">\(\text{Pr}(\chi^2_{7} &gt; \text{x}^2_\text{obs})\)</span>, which we can evaluate in with</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="gof.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(test_stat, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## [1] 0.001807201</code></pre>
<p>As <span class="math inline">\(p\)</span>-value <span class="math inline">\(&lt; 0.01\)</span>, we have evidence at the 1% significance level to reject <span class="math inline">\(H_0\)</span>, and conclude that the daily Teignmouth rainfall amounts aren’t Exp(<span class="math inline">\(\hat \theta\)</span>) distributed. <span style="float:right;"> ⬛ </span> </p>
<hr />
<p>For small sample sizes, e.g. <span class="math inline">\(n \leq 20\)</span>, <em>Yates’ continuity correction</em> is recommended. This modifies the above with <span class="math inline">\((|O_i - E_i| - 0.5)^2 / E_i\)</span> inside the summation of equation <a href="gof.html#eq:chisq">(5.5)</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>Karl Pearson (1857–1936) was a busy man, and invented many statistical techniques, including the correlation coefficient and chi-squared test, and gave he the histogram its name. Most of these were developed to help with his work on biometrics. Pearson’s book <em>The Grammar of Science</em> became a firm favourite of Albert Einstein.<a href="gof.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pcdf.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="kde.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
